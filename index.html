<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>IAMOBI - SISTEMA INTEGRADO V7.0</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap');

        body { 
            background: #020408; color: #f8fafc; font-family: 'Rajdhani', sans-serif; 
            margin: 0; padding: 15px; display: flex; flex-direction: column; align-items: center; 
        }

        .container { width: 100%; max-width: 420px; }

        .header { 
            text-align: center; padding: 20px; border: 1px solid #1ed760; border-radius: 15px; 
            margin-bottom: 25px; background: rgba(30, 215, 96, 0.02);
            box-shadow: 0 0 20px rgba(30, 215, 96, 0.1);
        }
        .header h1 { font-family: 'Orbitron', sans-serif; font-size: 1.8rem; color: #1ed760; margin: 0; text-shadow: 0 0 10px #1ed760; }

        .card { 
            background: linear-gradient(145deg, #0f172a 0%, #020617 100%); 
            border-radius: 24px; padding: 25px; margin-bottom: 15px; 
            border: 1px solid rgba(255,255,255,0.05); box-shadow: 10px 10px 30px rgba(0,0,0,0.5);
            position: relative; overflow: hidden;
        }
        .utb { border-left: 4px solid #f97316; }
        .brb { border-left: 4px solid #3b82f6; }

        h2 { margin: 0; font-size: 1rem; color: #fff; font-family: 'Orbitron', sans-serif; letter-spacing: 2px; text-transform: uppercase; }

        /* Estiliza√ß√£o do campo CPF */
        .input-cpf {
            width: 100%; padding: 15px; margin-top: 15px; background: rgba(255,255,255,0.05);
            border: 1px solid rgba(30, 215, 96, 0.3); border-radius: 12px; color: #fff;
            font-family: 'Orbitron', sans-serif; text-align: center; font-size: 1.1rem; outline: none;
        }
        .input-cpf:focus { border-color: #1ed760; box-shadow: 0 0 10px rgba(30, 215, 96, 0.2); }

        .btn { 
            padding: 18px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; 
            color: #fff; font-size: 0.85rem; text-transform: uppercase; width: 100%; 
            font-family: 'Orbitron', sans-serif; transition: 0.1s; margin-top: 15px;
            box-shadow: 0 6px 0px rgba(0,0,0,0.5);
        }
        .btn:active { transform: translateY(3px); box-shadow: 0 3px 0px rgba(0,0,0,0.5); }
        
        .btn-utb { background: linear-gradient(to bottom, #f97316, #c2410c); }
        .btn-robot { background: linear-gradient(to bottom, #00f2ff, #0066ff); text-shadow: 0 0 5px #fff; } 
        .btn-saldo { background: linear-gradient(to bottom, #475569, #1e293b); border: 1px solid rgba(255,255,255,0.1); }
        .btn-brb { background: linear-gradient(to bottom, #3b82f6, #1d4ed8); }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        
        .infinite { 
            background: linear-gradient(to bottom, #1ed760, #15803d); 
            color: #000; grid-column: span 2; box-shadow: 0 5px 0px #065f46; 
        }

        .btn-inter { background: #ff7a00; box-shadow: 0 5px 0px #b35600; }
        .btn-nubank { background: #820ad1; box-shadow: 0 5px 0px #4c067a; }

        #area-pix { display: none; margin-top: 15px; background: rgba(30, 215, 96, 0.1); padding: 15px; border-radius: 12px; border: 1px dashed #1ed760; }
        .pix-code { font-size: 0.7rem; word-break: break-all; color: #1ed760; font-family: monospace; }

        footer { margin-top: 30px; font-size: 0.65rem; color: #334155; font-family: monospace; letter-spacing: 2px; text-align: center;}
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>IAMOBI</h1>
        <small style="color:#1ed760">SISTEMA DE ALTA AUTORIDADE</small>
    </div>

    <div class="card utb">
        <h2>UTB RECARGAS</h2>
        <input type="text" id="cpf-usuario" class="input-cpf" placeholder="DIGITE O CPF">
        
        <button id="btn-automacao" class="btn btn-robot" onclick="gerarPixCpf()">ü§ñ GERAR PIX VIA CPF</button>

        <div id="area-pix">
            <div class="pix-code" id="pix-display"></div>
            <button class="btn btn-saldo" style="margin-top:10px" onclick="copiarPixExtraido()">COPIAR PIX GERADO</button>
        </div>
        
        <button class="btn btn-utb" onclick="diretoUTB('03620000035530', '4')">MODO MANUAL (COPIAR ID)</button>
    </div>

    <div class="card brb">
        <h2>BRB MOBI</h2>
        <button class="btn btn-brb" onclick="smartRecarga('1023449012')">ABRIR TERMINAL BRB</button>
    </div>

    <div class="grid">
        <button class="btn infinite" onclick="copyPix('00020101021226580014BR.GOV.BCB.PIX0115pay@droppfy.com0217Pagamento droppfy52040000530398654040.015802BR5925CRISTIAN RIBEIRO FLORENCI6015AGUAS LINDAS DE62290525QRCCVzF3XA7wIYGazhMXHFZnc6304631B')">PIX MANUTEN√á√ÉO (CRISTIAN)</button>
        <button class="btn btn-inter" onclick="openBank('inter')">INTER</button>
        <button class="btn btn-nubank" onclick="openBank('nubank')">NUBANK</button>
    </div>

    <footer>PROTOCOLO V7.0 | CLOUD INTEGRATED</footer>
</div>

<script>
    let pixCapturado = "";

    async function gerarPixCpf() {
        const cpf = document.getElementById('cpf-usuario').value;
        const btn = document.getElementById('btn-automacao');
        const areaPix = document.getElementById('area-pix');
        const display = document.getElementById('pix-display');

        if(!cpf) { alert("INFORME O CPF!"); return; }

        btn.innerText = "ü§ñ PROCESSANDO NA NUVEM...";
        btn.style.opacity = "0.7";

        try {
            // Rota configurada para o seu servidor
            const response = await fetch('http://192.168.100.2:5000/gerar_por_cpf', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ cpf: cpf })
            });

            const data = await response.json();

            if (data.status === "sucesso") {
                pixCapturado = data.pix;
                display.innerText = pixCapturado;
                areaPix.style.display = "block";
                btn.innerText = "‚úÖ SUCESSO!";
                
                // Copia autom√°tica para facilitar
                await navigator.clipboard.writeText(pixCapturado);
                alert("PIX GERADO E COPIADO!");
            } else {
                alert("ERRO: " + data.mensagem);
                btn.innerText = "ü§ñ TENTAR NOVAMENTE";
            }
        } catch (err) {
            alert("SERVIDOR OFFLINE OU ERRO DE REDE");
            btn.innerText = "ü§ñ GERAR PIX VIA CPF";
        }
        btn.style.opacity = "1";
    }

    function copiarPixExtraido() {
        if(pixCapturado) {
            navigator.clipboard.writeText(pixCapturado);
            alert("PIX COPIADO!");
        }
    }

    // --- FUN√á√ïES DE NAVEGA√á√ÉO MANTIDAS ---
    function diretoUTB(id, digito) {
        navigator.clipboard.writeText(id).then(() => {
            alert("ID COPIADO! Redirecionando...");
            window.location.href = "https://www.utb.com.br/recarga";
        });
    }

    function openBank(banco) {
        const links = {
            'inter': 'intent://#Intent;scheme=inter;package=br.com.intermedium;end',
            'nubank': 'intent://#Intent;scheme=nubank;package=com.nu.production;end'
        };
        window.location.href = links[banco];
    }
</script>
</body>
</html>
